# -*- encoding: ascii-8bit -*-
require 'benchmark'

total = (ENV['TOTAL'] || 50_000).to_i

S = ["i#\t\022;\226\243\003", "\237\361X\227\370'\302\255'",
     "\272m\246\v&\213&\314\254\347", "\230\247\020\315", "\353\024!\247", "e",
     ",,\342?N\347e", ")\265J\206\357\373\223V\223D", "Y\340>\244Y\314\310",
     "#C\360\347\035\353(\200\273"]
M = ["\214\350\210Qcx", "\371y\242\316\251", "\020\375", "\217\001\352\026",
     "\205", "c|\323L\233V\256", "\301Z", "\352\311", "\363", "\310\333\002",
     "S\232\206\231", "B\305F\2109S", ")\034\343\037", "\316\303", ",",
     ":c\212\235", "<\340\a", "\237\t\252", "\004(\025", "\262\021\346\275",
     "\317\037\335\231\233\177\225\026\211", "\323w\021\341\\\233", "\n\330",
     "s\332\210>\227\360\\", "\243H\321"]
L = ["\020\360\026\341\204e\351\213k", "\354", "t\321A\276\260<2QS", "\350",
     "\206|\212\030\266", "7\f\370\350\270\211\203F'\221",
     "\201\375\225}\204\234", "G\002\322\356\230", "A\004\251\017*\212\355\000g",
     "\355", "\222N\3213\317\325\250", "z\321\t:C\2343\271",
     "6\3403\022\361\217\232M", "\271v<\222\304", "\301|\342", "\201@\342",
     "p9\245\277", "P4\207", "}\035\244", ",&\316^3\367;",
     "\211\302\306\346\210\206", "\025+s\017P\374\0374k",
     "\322\320S\245V=\036\3602\231", "Y\3516*\"", "\244", "\336\323=\327",
     "\224\036\303\310\"\224\326\r\242", "\320\177C\363\277)\3604\217",
     "<>\303\206\030\275\331l", "\231xt\016\326", "u\335\321",
     "\202\376\234J\317\340Tc\313", "[\247\354N@pk;-", "\217c", "\a\e",
     "\001\001\353", "\316\347se", "\017\367\346", "\263$X\275\327\354", "\302",
     "!\231\303\nP[", "\276\345\354\231", "~w\n\035L\202:\254", "b\231", "$",
     "\005", "\034\\", "\227!W#\220", "7b", "DIp\340{\203\350\2643u"]
X = ["\023", "\311(;\3450\320", "\302\r?\322\245",
     "\274\301\265\270\303\024\211.4\266", "z@", "\201nvYX\203\274", "6F", "\r",
     "/\245\301m\271", "\304\240`", "\303\247%\357\231\bd", "]\232Q.\215\246",
     "\\1D\252", "\321\235\230\302", "|\317\253\f]\255(\034W",
     "\373SR\205\327\320\024\305", "Z\263\316rqa\021", "\323",
     "\226\322\362T\314DP\215@", "r2\242\037", "!\3335\223",
     "'YZ\362O\326\341\204", "\260\260< \306", "\277", "\202", "\3648YV\276",
     "~\307a0\3413", "\353~\213\026\237\254\232\eq\336", "\2627\177\270",
     "\027X\r\304", "~y4", "4\217+\"", "n\025@\322\226f", "H\251%\365,{0\311",
     "?J\234\334p", "e\375", "Ap\206\025\023\004X",
     "\177\255K\374\247\315X\346j", "A>B\f\300%\314P",
     "\252\370\177\310\016a~\260=\212", "9\330R\em", "\220'\301", "N",
     "\017[\330", "\301\003}\002\a\000\262j>", "\311", "\332\307T",
     "\263\216\034\247\330\354&", "VCu\003\0041\304$y",
     "\f\350\223G\237\017\360\032\225a", "\304\262\216\202D",
     "b\022\343\017\261", "q\024\322\374\346\337M", "\aN\321N\304v\235Z",
     "FE@\375\346", "\035\236\000\323\214<\243r", "\336^\266\235,\332", "H",
     "N6\215\223\250\336\032\026Ph", "\312\351\025\276X\311\036\345\236\255",
     "\002\364\313\340\3218\245\3654\205", "p\005Cy", "f\242&\024\227L\300",
     "\361\251\253<", "T>\222\215", "\016\247\177\345", "\364\247\b\022\240Eb_",
     "\376M\311\a-\372\202", "\260\201", "\330\364\346\376pQ\204",
     "BN4\3419\350", "\314F\206", "c\3321\326\346j\213\200",
     "\356\372]\244\233_J\vH", "<\031\346>-", "zt\245\214\222\276",
     "Q\037\250\327%\016#?Q", "h\340g&\203\335[\347", "=", "N[", "\272f",
     "\340\224\005%z\022", "\313\a\305\212ah\237\316>", "\f\300\321\316", "M\b",
     "rS\227H\322\310\230\320t", "\337BRc\330\345ZjVP", "+\352\261}
     \367\272\301", "S\0328\322g\205\264", "x\265", "Mk\237\314",
     ",J\307\226ZcR\2167", "\315\e\217\227f\244{", "\254", "'\031\224\215#\254",
     "\310\2609]\313\n:\224\203", "\371\225\320\322\035C/", "<",
     "\245y\344wZ\222\035", "\205\265\032B;\2356s", "\363\003\224\035",
     "\230\227\344\253", "D\220\343K\203\030\003", "\a\251`\265", "4/u\242\260",
     "\034:k\366\372KLQ\t", "\2738G%", "\332\364'\264\003\316D\036",
     "\203I\036\242\366\213\262\246", "%\313&\304\326\230\257|iC",
     "\217\313\v\350\025TM", "\v\373v\000\320", "\203R", "\263\t\342*Bx(\036",
     "VS\240\334\374@", "\210", "\254", "O\263K\361",
     "<\374\226\222\355x\t\003\323\230", "\224\242ah\214\346", "f",
     "']\025\t\333k\025\333\035O", "\277\003'", "Y\362\363YO\233\270\001\375", "
     ?2\335", "J\3460N\334\336\225v\276", "\200", "\361\273\324Q-\2101_z\337",
     "\220\354\236D<bez8", "\345\346#\263o}\215\344", "\331\031\215d\327\273",
     "\n\r\034-\212\371\371\254H\177", "j\032z\316\023\301\326D\345",
     "\000\343\344\363#\365\375\001p", "\333\202\263\212\303\026/",
     "F@\366@\326\326\322w\313\362", "}O\245B+\025\251\177=\266",
     "p\315\322ZB\277\240}\363", "\001\255", "\307\326\232sC{",
     "b\264\234\243m[:", "i\300\303H\274\261\363$\000\347", "\222\b\362\314.",
     "wW\035\020[\375\303", "\244\000", "\366\324", "M\251",
     "\260~\320\006\371\312", "\327\242\344g+\a", "\230FAq", "\303D",
     "B\363\212\262G", "3", "\217\223r\\\201\tJ\a", "+", "\022\261&\347\a\275",
     "\305\002\372\312\231\226W\305", "\002h\tG\353\317", "\367\361",
     "\225\247\245\247\226", "*?\376\364DG\360\326\256",
     "b\237\346U_\235\372\250$", "\327\r]\310>",
     "TU\307\025\303\212\350\250\337", "fu\\\335\333", "\333#Y",
     "\207\341\324\364\341\bS\275\312\246", "\346", ")\351",
     "\362]_\362\024'5\362}\311", "kw\267\265*\373", "u", "\311\030", "D5\211",
     "\360\360\244", "7:U\236\347Z\004", "%\301Y\022\334^\032*\361d",
     "\220?\355\242\236&", "t7(\336W\350", ":", "\031V5\255\337\002\221K",
     "\300T}\315\257\250\241\000", ":\346\375", "\337)",
     "\205DA\313\250\335\306+\374", "qg_\204\2446\313'", "\237?\356\031B+",
     "\220q\270v$\217\200", "\357o\211\000[\211\247\t\262,", "\270",
     "\250UR\036m\021<\216E1", "n\205\3533Nw", "\361,\305\350Y\e\226\250N",
     "\262\253\351\376", "?\331\275:NU\264", "\302\264", "\275i_M",
     "\365\312Mh$", "cWX\353\223\353\276", "U#\"C\246", "\375n\017P\300\300e",
     "\035\206\355\036\210", "h", ")t\334Z\246\301\350\236,",
     "\210]a;c\025\200\350", "\224\213\250\205", "\203\364<z\253\233(\237h;",
     "\234C\271^\340", "\0212\201\334", "\000|@", "\343u",
     "U\251\253\315t\237\202\f\262", "a\250~E\004", "8",
     "\251\254}\264\303\267P\212\317", "\362@\324\212\2223\336D\313L",
     "\244\340\356\212Z\026/", "\253y\017\353\327\215\203J",
     "@\306\340\335\277", "\310\355", "\212\217\371", "\354", "\vg,`",
     "\201\276f\216}\274m\226\231", "+\224", "\342j|}\374", "%\202\270",
     "l\370\017\230\334&\\\303\001\t", "\214V\004\276\215\216;[\245",
     "\275ho\002\034.R\311xq", "\264}\326\364|E", "\334u^j<v",
     "\216\031IEY\342>", "\025Z0\252\356\256%\004\207", "D", "\345\226",
     "Tl\350\231\277\304\\\210\366v", "\f\313", "\211q!\340\355",
     "\235\331\351\337", "\315(\366\030\272\257~2", "\002\304\021\326ew\207",
     "\353\305\3657|\355?\242\373\005", ")&y\364\330\3307\240\313",
     "\370\247\204\322\332\334\337T", "\034a\026\347^", "\"+A\365\353",
     "w\267\2421A~XR", "\001w\220\273\216\0342\341|\247", "\336",
     "\334G\215\277\234", "\352\325\363", "\374\276", "\246D",
     "\004\001\361\257\213\216"]

Benchmark.bmbm do |x|
  x.report("loop") do
    d = "A*" * S.size
    total.times { 1 }
  end

  x.report("[S].pack('A*')") do
    d = "A*" * S.size
    total.times { S.pack(d) }
  end

  x.report("[S].pack('a*')") do
    d = "a*" * S.size
    total.times { S.pack(d) }
  end

  x.report("[S].pack('Z*')") do
    d = "Z*" * S.size
    total.times { S.pack(d) }
  end

  x.report("[S].pack('A20')") do
    d = "A20" * S.size
    total.times { S.pack(d) }
  end

  x.report("[S].pack('a20')") do
    d = "a20" * S.size
    total.times { S.pack(d) }
  end

  x.report("[S].pack('Z20')") do
    d = "Z20" * S.size
    total.times { S.pack(d) }
  end

  x.report("[M].pack('A*')") do
    d = "A*" * M.size
    total.times { M.pack(d) }
  end

  x.report("[M].pack('a*')") do
    d = "a*" * M.size
    total.times { M.pack(d) }
  end

  x.report("[M].pack('Z*')") do
    d = "Z*" * M.size
    total.times { M.pack(d) }
  end

  x.report("[L].pack('A*')") do
    d = "A*" * L.size
    total.times { L.pack(d) }
  end

  x.report("[X].pack('A*')") do
    d = "A*" * X.size
    total.times { X.pack(d) }
  end
end
